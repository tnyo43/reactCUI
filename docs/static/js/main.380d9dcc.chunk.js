(this["webpackJsonpreact-cui"]=this["webpackJsonpreact-cui"]||[]).push([[0],{13:function(e,t,n){e.exports=n(21)},18:function(e,t,n){},19:function(e,t,n){},20:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),s=n(11),a=n.n(s),o=(n(18),n(1)),c=n(2),u=n(5),h=n(4),l=n(3),m=function(e){return i.a.createElement("div",null,e.history.map((function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"cli-text"},i.a.createElement("span",{className:"user-span"},e.username),i.a.createElement("span",{className:"dir-span"},"".concat(e.entry.getName()," $")),i.a.createElement("span",null,e.command)),i.a.createElement("div",{className:"cli-result"},e.result.map((function(e){return i.a.createElement("div",null,e)}))))})))},d=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).inputRef=void 0,r.state={command:"",escapedCommand:"",index:0},r.onKeyDown=r.onKeyDown.bind(Object(u.a)(r)),r.inputRef=i.a.createRef(),r}return Object(c.a)(n,[{key:"onKeyDown",value:function(e){var t,n;switch(e.keyCode){case 13:this.props.executeCommand(this.state.command),this.setState({command:"",escapedCommand:"",index:this.props.history.length});break;case 38:n=this.state.index===this.props.history.length?this.state.command:this.state.escapedCommand,t=Math.max(0,this.state.index-1),this.setState({command:this.props.history[t],escapedCommand:n,index:t});break;case 40:t=Math.min(this.props.history.length,this.state.index+1),this.setState({command:t===this.props.history.length?this.state.escapedCommand:this.props.history[t],index:t})}}},{key:"focus",value:function(){this.inputRef.current&&this.inputRef.current.focus()}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"input-div"},i.a.createElement("span",{className:"user-span"},this.props.username),i.a.createElement("span",{className:"dir-span"},"".concat(this.props.entry.getName()," $")),i.a.createElement("input",{ref:this.inputRef,className:"cli-input",onChange:function(t){return e.setState({command:t.target.value})},value:this.state.command,onKeyDown:this.onKeyDown}))}}]),n}(i.a.Component),y=n(12),f=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(o.a)(this,n),r=t.call(this,e),Object.setPrototypeOf(Object(u.a)(r),n.prototype),r}return n}(Object(y.a)(Error)),v=function(){function e(){Object(o.a)(this,e),this._parent=void 0,this._parent=null}return Object(c.a)(e,[{key:"getRoot",value:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},{key:"add",value:function(e){throw new f('this Entry is NOT able to executable "add"')}},{key:"pwd",value:function(){return((null===this.parent?"":this.parent.pwd())+"/"+this.getName()).replace("//","/")}},{key:"mkdir",value:function(e){throw new f('this Entry is NOT able to executable "mkdir"')}},{key:"get",value:function(e,t){throw new f('this Entry is NOT able to executable "get"')}},{key:"cd",value:function(e){throw new f('this Entry is NOT able to executable "cd"')}},{key:"ls",value:function(){throw new f('this Entry is NOT able to executable "ls"')}},{key:"edit",value:function(e){throw new f('this Entry is NOT able to executable "edit"')}},{key:"cat",value:function(){throw new f('this Entry is NOT able to executable "cat"')}},{key:"parent",get:function(){return this._parent},set:function(e){this._parent=e}}]),e}(),p=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this)).name=void 0,r.content=void 0,r.name=e,r.content="",r}return Object(c.a)(n,[{key:"edit",value:function(e){this.content=e}},{key:"cat",value:function(){return this.content}},{key:"getName",value:function(){return this.name}}]),n}(v),k=n(9),g=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;if(Object(o.a)(this,n),(r=t.call(this)).name=void 0,r.directory=void 0,""===e)throw new f("directory with empty name is invalid");return r.name=e,r.directory=[],r}return Object(c.a)(n,[{key:"add",value:function(e){return this.directory.push(e),e.parent=this,e}},{key:"mkdir",value:function(e){this.directory.forEach((function(t){if(t.getName()===e)throw new f("mkdir: ".concat(e,": File exists"))}));var t=new n(e);return this.add(t),t}},{key:"get",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"get",r=Object(k.a)(this.directory);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.getName()===e)return i}}catch(s){r.e(s)}finally{r.f()}throw new f("".concat(n,": no such file or directory: ").concat(e))}},{key:"cd",value:function(e){var t=this.get(e,"cd");if(t instanceof n)return t;throw new f("cd: not a directory: ".concat(e))}},{key:"ls",value:function(){return this.directory.map((function(e){return e.getName()})).sort()}},{key:"cat",value:function(){throw new f("cat: ".concat(this.getName(),": Is a directory"))}},{key:"getName",value:function(){return this.name}}],[{key:"root",value:function(){return function(){var e=new n("root");return e.name="",e}()}}]),n}(v),x=function(){function e(t,n,r){Object(o.a)(this,e),this._username=void 0,this.entry=void 0,this._context=void 0,this._context=t,this._username=n,this.entry=r}return Object(c.a)(e,[{key:"help",value:function(e){return{username:this._username,entry:this.entry,command:e,result:["Basic commands","","pwd :show path of current directory.","cd [dir] :change directory.","ls :list segments.","mkdir [dir] :create new directory.","cat [file] :open txt or md files.","vim [file] :edit file with vim."]}}},{key:"pwd",value:function(e){return{username:this._username,entry:this.entry,command:e,result:[this.entry.pwd()]}}},{key:"cd",value:function(e,t){var n=this.entry;if(0===e.length){for(this.entry=this.entry.getRoot();null!==this.entry.parent;)this.entry=this.entry.parent;return{username:this._username,entry:n,command:t,result:[]}}var r=[];if(".."===e[0])this.entry=this.entry.parent?this.entry.parent:this.entry;else{var i=e[0].split("/").filter((function(e){return""!==e}));try{var s,a=Object(k.a)(i);try{for(a.s();!(s=a.n()).done;){var o=s.value;this.entry=this.entry.cd(o)}}catch(c){a.e(c)}finally{a.f()}}catch(u){if(!(u instanceof f))throw u;this.entry=n,r.push(u.message)}}return{username:this._username,entry:n,command:t,result:r}}},{key:"ls",value:function(e){return{username:this._username,entry:this.entry,command:e,result:this.entry.ls()}}},{key:"mkdir",value:function(e,t){if(0===e.length)return{username:this._username,entry:this.entry,command:t,result:["usage: mkdir directory"]};var n=[];try{this.entry.mkdir(e[0])}catch(r){if(!(r instanceof f))throw r;n.push(r.message)}return{username:this._username,entry:this.entry,command:t,result:n}}},{key:"cat",value:function(e,t){if(0===e.length)return{username:this._username,entry:this.entry,command:t,result:["usage: cat file"]};var n=[];try{n=n.concat(this.entry.get(e[0],"cat").cat().split("\n"))}catch(r){if(!(r instanceof f))throw r;n.push(r.message)}return{username:this._username,entry:this.entry,command:t,result:n}}},{key:"vim",value:function(e,t){var n=e[0],r=null;try{r=this.entry.get(n,"vim")}catch(i){r=new p(n)}return r instanceof p?(this._context.setVim(r),this._context.changeMode("vim"),{username:this._username,entry:this.entry,command:t,result:[]}):{username:this._username,entry:this.entry,command:t,result:["vim: ".concat(this.entry.getName(),": Is a directory")]}}},{key:"execute",value:function(e){var t=e.split(" ").filter((function(e){return""!==e}));if(0===t.length)return{username:this._username,entry:this.entry,command:e,result:[]};var n=t.slice(1);switch(t[0]){case"help":return this.help(e);case"pwd":return this.pwd(e);case"cd":return this.cd(n,e);case"ls":return this.ls(e);case"mkdir":return this.mkdir(n,e);case"cat":return this.cat(n,e);case"vim":return this.vim(n,e);default:return{username:this._username,entry:this.entry,command:e,result:["command not found: ".concat(t[0])]}}}},{key:"username",get:function(){return this._username}},{key:"dir",get:function(){return this.entry}}],[{key:"getInstance",value:function(t,n,r){if(e.singleton)return e.singleton;var i=new e(t,n,r);return e.singleton=i,i}}]),e}();x.singleton=void 0;var w=function(){function e(t){Object(o.a)(this,e),this._context=void 0,this._file=void 0,this.entry=void 0,this._text=void 0,this.mode=void 0,this.colon=void 0,this._cursor=void 0,this._context=t,this.entry=g.root(),this._file=new p(""),this._text=[""],this.mode="command",this.colon="",this._cursor=[0,0]}return Object(c.a)(e,[{key:"splitTextByEnter",value:function(){var e=this._text.slice(0,this.cursor[0]),t=this._text[this.cursor[0]];e=(e=e.concat([t.substring(0,this.cursor[1]),t.substring(this.cursor[1],t.length)])).concat(this._text.slice(this.cursor[0]+1)),this._text=e}},{key:"executeColon",value:function(){this.colon.indexOf("w")>-1&&(this._file.parent!==this.entry&&this.entry.add(this._file),this._file.edit(this.text.join("\n"))),this.colon.indexOf("q")>-1&&(this._context.changeMode("normal"),this.cursor=[0,0]),this.colon=""}},{key:"insertText",value:function(e){if(1===e.length){var t=this.cursor[0],n=this.cursor[1],r=this._text[t];this._text[t]=r.slice(0,n)+e+r.slice(n)}}},{key:"onKeyDown",value:function(e){switch(console.log(this),this.mode){case"command":return this.commandKeyDown(e);case"colon":return this.colonKeyDown(e);case"insert":return this.insertKeyDown(e)}}},{key:"insertKeyDown",value:function(e){switch(e.keyCode){case 27:this.mode="command";break;case 13:this.splitTextByEnter(),this.cursor=[this._cursor[0]+1,0];break;default:this.insertText(e.key),this.cursor=[this._cursor[0],this._cursor[1]+1]}return this.cursor}},{key:"commandKeyDown",value:function(e){switch(console.log(e.keyCode),e.keyCode){case 65:this.mode="insert",this.cursor=[this._cursor[0],this._cursor[1]+1];break;case 73:this.mode="insert";break;case 72:this.cursor=[this._cursor[0],this._cursor[1]-1];break;case 74:case 13:this.cursor=[this._cursor[0]+1,this._cursor[1]];break;case 75:this.cursor=[this._cursor[0]-1,this._cursor[1]];break;case 76:this.cursor=[this._cursor[0],this._cursor[1]+1];break;case 186:this.mode="colon"}return this.cursor}},{key:"colonKeyDown",value:function(e){switch(e.keyCode){case 13:this.executeColon(),this.mode="command";break;case 81:this.colon=this.colon+"q";break;case 87:this.colon+="w"}return this.cursor}},{key:"getModeText",value:function(){switch(this.mode){case"command":return"-- COMMAND --";case"colon":return":"+this.colon;case"insert":return"-- INSERT --"}}},{key:"getcursorChar",value:function(){var e=this.cursor[0],t=this.cursor[1];return t>=this.text[e].length?" ":this.text[e][t]}},{key:"setFile",value:function(e,t){this.entry=t,this._file=e,this._text=e.cat().split("\n")}},{key:"file",get:function(){return this._file}},{key:"text",get:function(){return this._text}},{key:"cursor",set:function(e){0===this._text.length&&(this._cursor=[0,0]),this._cursor[0]=Math.max(0,Math.min(this._text.length-1,e[0])),this._cursor[1]=Math.min(this._text[this._cursor[0]].length,Math.max(0,e[1]))},get:function(){return this._cursor}}],[{key:"getInstance",value:function(t){if(e.singleton)return e.singleton;var n=new e(t);return e.singleton=n,n}}]),e}();w.singleton=void 0;var b=function(){function e(t,n){Object(o.a)(this,e),this.mode=void 0,this.executeCommand=void 0,this.executeVim=void 0,this.mode="normal",this.executeCommand=x.getInstance(this,t,n),this.executeVim=w.getInstance(this)}return Object(c.a)(e,[{key:"getMode",value:function(){return this.mode}},{key:"getExecute",value:function(){switch(console.log(this.mode),this.mode){case"normal":return this.executeCommand;case"vim":return this.executeVim}}},{key:"setVim",value:function(e){this.executeVim.setFile(e,this.executeCommand.dir)}},{key:"changeMode",value:function(e){console.log("CHANGE MODE: ".concat(this.mode," -> ").concat(e)),this.mode=e}}],[{key:"getInstance",value:function(t,n){if(this.singleton)return this.singleton;var r=new e(t,n);return this.singleton=r,r}}]),e}();b.singleton=void 0;n(19);var _=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={cursor:r.props.exec.cursor},r.onKeyDown=r.onKeyDown.bind(Object(u.a)(r)),r}return Object(c.a)(n,[{key:"onKeyDown",value:function(e){var t=this.props.exec.onKeyDown(e);this.setState({cursor:t}),"vim"!==this.props.context.getMode()&&this.props.forceRenderCallback()}},{key:"render",value:function(){return i.a.createElement("div",{className:"vim-app",onKeyDown:this.onKeyDown,tabIndex:0},i.a.createElement("div",{className:"vim-app-edit-area"},this.props.exec.text.map((function(e){return i.a.createElement("div",null,e)}))),i.a.createElement("div",{className:"vim-mode-text"},this.props.exec.getModeText()),i.a.createElement("div",{className:"vim-cursor",style:{top:29*this.state.cursor[0],left:12.25*this.state.cursor[1]}},this.props.exec.getcursorChar()))}}]),n}(i.a.Component),O=(n(20),function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e))._context=void 0,r.inputRef=void 0,r.handleClick=function(){r.inputRef.current&&r.inputRef.current.focus()},r.state={history:[]},r._context=b.getInstance("tomoya",function(){var e=g.root(),t=new g("product"),n=new g("documents");e.add(t),e.add(n);var r=new p("poem.txt");r.edit("poepoe poem");var i=new p("photo.png");t.add(r),t.add(i);var s=new p("memo.txt");s.edit("memo is memorial");var a=new p("note.tex");return n.add(s),n.add(a),e}()),r.executeCommand=r.executeCommand.bind(Object(u.a)(r)),r.forceRenderCallback=r.forceRenderCallback.bind(Object(u.a)(r)),r.inputRef=i.a.createRef(),r}return Object(c.a)(n,[{key:"executeCommand",value:function(e){var t=this._context.getExecute();if(t instanceof x){var n=t.execute(e);this.setState({history:this.state.history.concat([n])})}}},{key:"forceRenderCallback",value:function(){this.forceUpdate()}},{key:"render",value:function(){var e=this._context.getExecute();return e instanceof x?i.a.createElement("div",{className:"App",onClick:this.handleClick},i.a.createElement(m,{history:this.state.history}),i.a.createElement(d,{ref:this.inputRef,username:e.username,entry:e.dir,history:this.state.history.map((function(e){return e.command})).filter((function(e){return e.replace(/\s/g,"").length>0})),executeCommand:this.executeCommand})):e instanceof w?i.a.createElement(_,{exec:e,forceRenderCallback:this.forceRenderCallback,context:this._context}):void 0}}]),n}(i.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(O,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[13,1,2]]]);
//# sourceMappingURL=main.380d9dcc.chunk.js.map