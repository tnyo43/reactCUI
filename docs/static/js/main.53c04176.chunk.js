(this["webpackJsonpreact-cui"]=this["webpackJsonpreact-cui"]||[]).push([[0],{13:function(t,e,n){t.exports=n(21)},18:function(t,e,n){},19:function(t,e,n){},20:function(t,e,n){},21:function(t,e,n){"use strict";n.r(e);var r=n(0),s=n.n(r),i=n(11),a=n.n(i),o=(n(18),n(1)),c=n(2),u=n(5),h=n(4),l=n(3),m=function(t){return s.a.createElement("div",null,t.history.map((function(t){return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"cli-text"},s.a.createElement("span",{className:"user-span"},t.username),s.a.createElement("span",{className:"dir-span"},"".concat(t.entry.getName()," $")),s.a.createElement("span",null,t.command)),s.a.createElement("div",{className:"cli-result"},t.result.map((function(t){return s.a.createElement("div",null,t)}))))})))},d=function(t){Object(l.a)(n,t);var e=Object(h.a)(n);function n(t){var r;return Object(o.a)(this,n),(r=e.call(this,t)).inputRef=void 0,r.state={command:"",escapedCommand:"",index:0},r.onKeyDown=r.onKeyDown.bind(Object(u.a)(r)),r.inputRef=s.a.createRef(),r}return Object(c.a)(n,[{key:"onKeyDown",value:function(t){var e,n;switch(t.keyCode){case 13:this.props.executeCommand(this.state.command),this.setState({command:"",escapedCommand:"",index:this.props.history.length});break;case 38:n=this.state.index===this.props.history.length?this.state.command:this.state.escapedCommand,e=Math.max(0,this.state.index-1),this.setState({command:this.props.history[e],escapedCommand:n,index:e});break;case 40:e=Math.min(this.props.history.length,this.state.index+1),this.setState({command:e===this.props.history.length?this.state.escapedCommand:this.props.history[e],index:e})}}},{key:"focus",value:function(){this.inputRef.current&&this.inputRef.current.focus()}},{key:"render",value:function(){var t=this;return s.a.createElement("div",{className:"input-div"},s.a.createElement("span",{className:"user-span"},this.props.username),s.a.createElement("span",{className:"dir-span"},"".concat(this.props.entry.getName()," $")),s.a.createElement("input",{ref:this.inputRef,className:"cli-input",onChange:function(e){return t.setState({command:e.target.value})},value:this.state.command,onKeyDown:this.onKeyDown}))}}]),n}(s.a.Component),y=n(12),f=function(t){Object(l.a)(n,t);var e=Object(h.a)(n);function n(t){var r;return Object(o.a)(this,n),r=e.call(this,t),Object.setPrototypeOf(Object(u.a)(r),n.prototype),r}return n}(Object(y.a)(Error)),v=function(){function t(){Object(o.a)(this,t),this._parent=void 0,this._parent=null}return Object(c.a)(t,[{key:"getRoot",value:function(){for(var t=this;null!==t.parent;)t=t.parent;return t}},{key:"add",value:function(t){throw new f('this Entry is NOT able to executable "add"')}},{key:"pwd",value:function(){return((null===this.parent?"":this.parent.pwd())+"/"+this.getName()).replace("//","/")}},{key:"mkdir",value:function(t){throw new f('this Entry is NOT able to executable "mkdir"')}},{key:"get",value:function(t,e){throw new f('this Entry is NOT able to executable "get"')}},{key:"cd",value:function(t){throw new f('this Entry is NOT able to executable "cd"')}},{key:"ls",value:function(){throw new f('this Entry is NOT able to executable "ls"')}},{key:"edit",value:function(t){throw new f('this Entry is NOT able to executable "edit"')}},{key:"cat",value:function(){throw new f('this Entry is NOT able to executable "cat"')}},{key:"parent",get:function(){return this._parent},set:function(t){this._parent=t}}]),t}(),p=function(t){Object(l.a)(n,t);var e=Object(h.a)(n);function n(t){var r;return Object(o.a)(this,n),(r=e.call(this)).name=void 0,r.content=void 0,r.name=t,r.content="",r}return Object(c.a)(n,[{key:"edit",value:function(t){this.content=t}},{key:"cat",value:function(){return this.content}},{key:"getName",value:function(){return this.name}}]),n}(v),k=n(9),x=function(t){Object(l.a)(n,t);var e=Object(h.a)(n);function n(t){var r;if(Object(o.a)(this,n),(r=e.call(this)).name=void 0,r.directory=void 0,""===t)throw new f("directory with empty name is invalid");return r.name=t,r.directory=[],r}return Object(c.a)(n,[{key:"add",value:function(t){return this.directory.push(t),t.parent=this,t}},{key:"mkdir",value:function(t){this.directory.forEach((function(e){if(e.getName()===t)throw new f("mkdir: ".concat(t,": File exists"))}));var e=new n(t);return this.add(e),e}},{key:"get",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"get",r=Object(k.a)(this.directory);try{for(r.s();!(e=r.n()).done;){var s=e.value;if(s.getName()===t)return s}}catch(i){r.e(i)}finally{r.f()}throw new f("".concat(n,": no such file or directory: ").concat(t))}},{key:"cd",value:function(t){var e=this.get(t,"cd");if(e instanceof n)return e;throw new f("cd: not a directory: ".concat(t))}},{key:"ls",value:function(){return this.directory.map((function(t){return t.getName()})).sort()}},{key:"cat",value:function(){throw new f("cat: ".concat(this.getName(),": Is a directory"))}},{key:"getName",value:function(){return this.name}}],[{key:"root",value:function(){return function(){var t=new n("root");return t.name="",t}()}}]),n}(v),g=function(){function t(e,n,r){Object(o.a)(this,t),this._username=void 0,this.entry=void 0,this._context=void 0,this._context=e,this._username=n,this.entry=r}return Object(c.a)(t,[{key:"help",value:function(t){return{username:this._username,entry:this.entry,command:t,result:["Basic commands","","pwd :show path of current directory.","cd [dir] :change directory.","ls :list segments.","mkdir [dir] :create new directory.","cat [file] :open txt or md files.","vim [file] :edit file with vim."]}}},{key:"pwd",value:function(t){return{username:this._username,entry:this.entry,command:t,result:[this.entry.pwd()]}}},{key:"cd",value:function(t,e){var n=this.entry;if(0===t.length){for(this.entry=this.entry.getRoot();null!==this.entry.parent;)this.entry=this.entry.parent;return{username:this._username,entry:n,command:e,result:[]}}var r=[];if(".."===t[0])this.entry=this.entry.parent?this.entry.parent:this.entry;else{var s=t[0].split("/").filter((function(t){return""!==t}));try{var i,a=Object(k.a)(s);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.entry=this.entry.cd(o)}}catch(c){a.e(c)}finally{a.f()}}catch(u){if(!(u instanceof f))throw u;this.entry=n,r.push(u.message)}}return{username:this._username,entry:n,command:e,result:r}}},{key:"ls",value:function(t){return{username:this._username,entry:this.entry,command:t,result:this.entry.ls()}}},{key:"mkdir",value:function(t,e){if(0===t.length)return{username:this._username,entry:this.entry,command:e,result:["usage: mkdir directory"]};var n=[];try{this.entry.mkdir(t[0])}catch(r){if(!(r instanceof f))throw r;n.push(r.message)}return{username:this._username,entry:this.entry,command:e,result:n}}},{key:"cat",value:function(t,e){if(0===t.length)return{username:this._username,entry:this.entry,command:e,result:["usage: cat file"]};var n=[];try{n=n.concat(this.entry.get(t[0],"cat").cat().split("\n"))}catch(r){if(!(r instanceof f))throw r;n.push(r.message)}return{username:this._username,entry:this.entry,command:e,result:n}}},{key:"vim",value:function(t,e){var n=t[0],r=null;try{r=this.entry.get(n,"vim")}catch(s){r=new p(n)}return r instanceof p?(this._context.setVim(r),this._context.changeMode("vim"),{username:this._username,entry:this.entry,command:e,result:[]}):{username:this._username,entry:this.entry,command:e,result:["vim: ".concat(this.entry.getName(),": Is a directory")]}}},{key:"execute",value:function(t){var e=t.split(" ").filter((function(t){return""!==t}));if(0===e.length)return{username:this._username,entry:this.entry,command:t,result:[]};var n=e.slice(1);switch(e[0]){case"help":return this.help(t);case"pwd":return this.pwd(t);case"cd":return this.cd(n,t);case"ls":return this.ls(t);case"mkdir":return this.mkdir(n,t);case"cat":return this.cat(n,t);case"vim":return this.vim(n,t);default:return{username:this._username,entry:this.entry,command:t,result:["command not found: ".concat(e[0])]}}}},{key:"username",get:function(){return this._username}},{key:"dir",get:function(){return this.entry}}],[{key:"getInstance",value:function(e,n,r){if(t.singleton)return t.singleton;var s=new t(e,n,r);return t.singleton=s,s}}]),t}();g.singleton=void 0;var _=function(){function t(e){Object(o.a)(this,t),this._context=void 0,this._file=void 0,this.entry=void 0,this._text=void 0,this.mode=void 0,this.colon=void 0,this._cursor=void 0,this._context=e,this.entry=x.root(),this._file=new p(""),this._text=[""],this.mode="command",this.colon="",this._cursor=[0,0]}return Object(c.a)(t,[{key:"splitTextByEnter",value:function(){var t=this._text.slice(0,this.cursor[0]),e=this._text[this.cursor[0]];t=(t=t.concat([e.substring(0,this.cursor[1]),e.substring(this.cursor[1],e.length)])).concat(this._text.slice(this.cursor[0]+1)),this._text=t}},{key:"backCursor",value:function(){0===this._cursor[0]&&(this.cursor=[0,this._cursor[1]-1]),this._cursor[1]}},{key:"delete",value:function(){if(0!==this._cursor[0]||0!==this._cursor[1]){var t=this._cursor[0],e=this._cursor[1];if(0===e){this._cursor[0]--,this._cursor[1]=this._text[this._cursor[0]].length;var n=this._text.slice(0,t-1);n.push(this._text[t-1]+this._text[t]),n=n.concat(this._text.slice(t+1)),this._text=n}else this._cursor[1]--,this._text[t]=this._text[t].slice(0,e-1).concat(this._text[t].slice(e))}}},{key:"executeColon",value:function(){this.colon.indexOf("w")>-1&&(this._file.parent!==this.entry&&this.entry.add(this._file),this._file.edit(this.text.join("\n"))),this.colon.indexOf("q")>-1&&(this._context.changeMode("normal"),this.cursor=[0,0]),this.colon=""}},{key:"insertText",value:function(t){if(1===t.length){var e=this.cursor[0],n=this.cursor[1],r=this._text[e];this._text[e]=r.slice(0,n)+t+r.slice(n)}}},{key:"onKeyDown",value:function(t){switch(console.log(this),this.mode){case"command":return this.commandKeyDown(t);case"colon":return this.colonKeyDown(t);case"insert":return this.insertKeyDown(t)}}},{key:"insertKeyDown",value:function(t){switch(t.keyCode){case 27:this.mode="command";break;case 13:this.splitTextByEnter(),this.cursor=[this._cursor[0]+1,0];break;case 8:this.delete();break;default:this.insertText(t.key),this.cursor=[this._cursor[0],this._cursor[1]+1]}return this.cursor}},{key:"commandKeyDown",value:function(t){switch(console.log(t.keyCode),t.keyCode){case 65:this.mode="insert",this.cursor=[this._cursor[0],this._cursor[1]+1];break;case 73:this.mode="insert";break;case 72:this.cursor=[this._cursor[0],this._cursor[1]-1];break;case 74:case 13:this.cursor=[this._cursor[0]+1,this._cursor[1]];break;case 75:this.cursor=[this._cursor[0]-1,this._cursor[1]];break;case 76:this.cursor=[this._cursor[0],this._cursor[1]+1];break;case 186:this.mode="colon"}return this.cursor}},{key:"colonKeyDown",value:function(t){switch(t.keyCode){case 13:this.executeColon(),this.mode="command";break;case 81:this.colon=this.colon+"q";break;case 87:this.colon+="w"}return this.cursor}},{key:"getModeText",value:function(){switch(this.mode){case"command":return"-- COMMAND --";case"colon":return":"+this.colon;case"insert":return"-- INSERT --"}}},{key:"getcursorChar",value:function(){var t=this.cursor[0],e=this.cursor[1];return e>=this.text[t].length?" ":this.text[t][e]}},{key:"setFile",value:function(t,e){this.entry=e,this._file=t,this._text=t.cat().split("\n")}},{key:"file",get:function(){return this._file}},{key:"text",get:function(){return this._text}},{key:"cursor",set:function(t){0===this._text.length&&(this._cursor=[0,0]),this._cursor[0]=Math.max(0,Math.min(this._text.length-1,t[0])),this._cursor[1]=Math.min(this._text[this._cursor[0]].length,Math.max(0,t[1]))},get:function(){return this._cursor}}],[{key:"getInstance",value:function(e){if(t.singleton)return t.singleton;var n=new t(e);return t.singleton=n,n}}]),t}();_.singleton=void 0;var w=function(){function t(e,n){Object(o.a)(this,t),this.mode=void 0,this.executeCommand=void 0,this.executeVim=void 0,this.mode="normal",this.executeCommand=g.getInstance(this,e,n),this.executeVim=_.getInstance(this)}return Object(c.a)(t,[{key:"getMode",value:function(){return this.mode}},{key:"getExecute",value:function(){switch(console.log(this.mode),this.mode){case"normal":return this.executeCommand;case"vim":return this.executeVim}}},{key:"setVim",value:function(t){this.executeVim.setFile(t,this.executeCommand.dir)}},{key:"changeMode",value:function(t){console.log("CHANGE MODE: ".concat(this.mode," -> ").concat(t)),this.mode=t}}],[{key:"getInstance",value:function(e,n){if(this.singleton)return this.singleton;var r=new t(e,n);return this.singleton=r,r}}]),t}();w.singleton=void 0;n(19);var b=function(t){Object(l.a)(n,t);var e=Object(h.a)(n);function n(t){var r;return Object(o.a)(this,n),(r=e.call(this,t)).state={cursor:r.props.exec.cursor},r.onKeyDown=r.onKeyDown.bind(Object(u.a)(r)),r}return Object(c.a)(n,[{key:"onKeyDown",value:function(t){var e=this.props.exec.onKeyDown(t);this.setState({cursor:e}),"vim"!==this.props.context.getMode()&&this.props.forceRenderCallback()}},{key:"render",value:function(){return s.a.createElement("div",{className:"vim-app",onKeyDown:this.onKeyDown,tabIndex:0},s.a.createElement("div",{className:"vim-app-edit-area"},this.props.exec.text.map((function(t){return s.a.createElement("div",null,t)}))),s.a.createElement("div",{className:"vim-mode-text"},this.props.exec.getModeText()),s.a.createElement("div",{className:"vim-cursor",style:{top:29*this.state.cursor[0],left:12.25*this.state.cursor[1]}},this.props.exec.getcursorChar()))}}]),n}(s.a.Component),O=(n(20),function(t){Object(l.a)(n,t);var e=Object(h.a)(n);function n(t){var r;return Object(o.a)(this,n),(r=e.call(this,t))._context=void 0,r.inputRef=void 0,r.handleClick=function(){r.inputRef.current&&r.inputRef.current.focus()},r.state={history:[]},r._context=w.getInstance("tomoya",function(){var t=x.root(),e=new x("product"),n=new x("documents");t.add(e),t.add(n);var r=new p("poem.txt");r.edit("poepoe poem");var s=new p("photo.png");e.add(r),e.add(s);var i=new p("memo.txt");i.edit("memo is memorial");var a=new p("note.tex");return n.add(i),n.add(a),t}()),r.executeCommand=r.executeCommand.bind(Object(u.a)(r)),r.forceRenderCallback=r.forceRenderCallback.bind(Object(u.a)(r)),r.inputRef=s.a.createRef(),r}return Object(c.a)(n,[{key:"executeCommand",value:function(t){var e=this._context.getExecute();if(e instanceof g){var n=e.execute(t);this.setState({history:this.state.history.concat([n])})}}},{key:"forceRenderCallback",value:function(){this.forceUpdate()}},{key:"render",value:function(){var t=this._context.getExecute();return t instanceof g?s.a.createElement("div",{className:"App",onClick:this.handleClick},s.a.createElement("div",{className:"cli-result"},"type 'help' to show commands"),s.a.createElement(m,{history:this.state.history}),s.a.createElement(d,{ref:this.inputRef,username:t.username,entry:t.dir,history:this.state.history.map((function(t){return t.command})).filter((function(t){return t.replace(/\s/g,"").length>0})),executeCommand:this.executeCommand})):t instanceof _?s.a.createElement(b,{exec:t,forceRenderCallback:this.forceRenderCallback,context:this._context}):void 0}}]),n}(s.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(O,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[13,1,2]]]);
//# sourceMappingURL=main.53c04176.chunk.js.map